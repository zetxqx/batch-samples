{
    "taskGroups": [
        {
            "task_spec": {
                "runnables": [
                    {
                        "script": {
                            "text": "#!/bin/bash\n\n# Script to configure Slurm's GPU resources in gres.conf\n\ncat <<EOF > /usr/local/etc/slurm/gres.conf\n# Define GPU resources\nName=gpu File=/dev/nvidia0\nName=gpu File=/dev/nvidia1\nEOF\n\n\ncat <<EOF > /usr/local/etc/slurm/slurm.conf\nSlurmctldHost=$(hostname)\nAuthType=auth/munge\nCryptoType=crypto/munge\nProctrackType=proctrack/pgid\nReturnToService=1\nGresTypes=gpu\nSlurmctldPidFile=/var/run/slurm/slurmctld.pid\nSlurmctldPort=6817\nSlurmdPidFile=/var/run/slurm/slurmd.pid\nSlurmdPort=6818\nSlurmdLogFile=/var/log/slurm/slurmd.log\nSlurmctldLogFile=/var/log/slurm/slurmctld.log\nSlurmdSpoolDir=/var/spool/slurmd\nSlurmUser=root\nStateSaveLocation=/var/spool/slurmctld\nSwitchType=switch/none\nTaskPlugin=task/none\nInactiveLimit=0\nKillWait=30\nMinJobAge=300\nSlurmctldTimeout=120\nSlurmdTimeout=300\nSchedulerType=sched/backfill\nSelectType=select/linear\nAccountingStorageType=accounting_storage/none\nClusterName=cluster\nSelectType=select/cons_tres\nSelectTypeParameters=CR_Core\nJobAcctGatherType=jobacct_gather/linux\nSlurmctldDebug=3\nSlurmdDebug=3\nNodeName=$(hostname) CPUs=2 Gres=gpu:2 State=UNKNOWN\nPartitionName=googlebatch Nodes=$(hostname) Default=YES MaxTime=INFINITE State=UP\nEOF\n\n\nmkdir -p /var/spool/slurm\nchmod 755 /var/spool/slurm/\ntouch /var/log/slurmctld.log\nmkdir -p /var/log/slurm\ntouch /var/log/slurm/slurmd.log /var/log/slurm/slurmctld.log\ntouch /var/log/slurm_jobacct.log /var/log/slurm_jobcomp.log\n\nsystemctl restart slurmd\nsleep 1\nsystemctl restart slurmctld\nsleep 2\n"
                        }
                    },
                    {
                        "script": {
                            "text": "sleep 1800"
                        }
                    }
                ]
            },
            "task_count": 1
        }
    ],
    "allocation_policy": {
        "location": {
            "allowed_locations": "zones/us-central1-a"
        },
        "instances": {
            "policy": {
                "accelerators": {
                    "type": "nvidia-tesla-v100",
                    "count": 2
                },
                "boot_disk": {
                    "image": "projects/projectofbob/global/images/image-ias-test",
                    "size_gb": 50
                }
            },
            "install_gpu_drivers": true
        }
    },
    "labels": {
        "goog-batch-dynamic-workload-scheduler": "true"
    },
    "logs_policy": {
        "destination": "CLOUD_LOGGING"
    }
}